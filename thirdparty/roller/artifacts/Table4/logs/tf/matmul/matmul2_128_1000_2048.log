WARNING:tensorflow:From ./src/matmul.py:9: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From ./src/matmul.py:9: The name tf.logging.ERROR is deprecated. Please use tf.compat.v1.logging.ERROR instead.

M, K, N, repeat_time: 128 2048 1000 10000
is eager mode:  True
2022-04-15 11:55:48.291962: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libamdhip64.so
2022-04-15 11:55:48.357976: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 0 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:3f:00.0
2022-04-15 11:55:48.358018: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 1 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:43:00.0
2022-04-15 11:55:48.358037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 2 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:46:00.0
2022-04-15 11:55:48.358053: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 3 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:49:00.0
2022-04-15 11:55:48.361741: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocblas.so
2022-04-15 11:55:48.363299: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libMIOpen.so
2022-04-15 11:55:48.379041: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocfft.so
2022-04-15 11:55:48.379317: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocrand.so
2022-04-15 11:55:48.379463: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1, 2, 3
2022-04-15 11:55:48.379806: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2022-04-15 11:55:48.393740: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2300000000 Hz
2022-04-15 11:55:48.397549: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x436e850 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-04-15 11:55:48.397579: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-04-15 11:55:48.398078: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 0 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:3f:00.0
2022-04-15 11:55:48.398115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 1 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:43:00.0
2022-04-15 11:55:48.398148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 2 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:46:00.0
2022-04-15 11:55:48.398173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 3 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:49:00.0
2022-04-15 11:55:48.398192: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocblas.so
2022-04-15 11:55:48.398205: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libMIOpen.so
2022-04-15 11:55:48.398216: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocfft.so
2022-04-15 11:55:48.398226: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocrand.so
2022-04-15 11:55:48.398351: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1, 2, 3
2022-04-15 11:55:48.398384: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-04-15 11:55:48.398392: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      0 1 2 3 
2022-04-15 11:55:48.398399: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 0:   N Y Y Y 
2022-04-15 11:55:48.398405: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 1:   Y N Y Y 
2022-04-15 11:55:48.398411: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 2:   Y Y N Y 
2022-04-15 11:55:48.398417: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 3:   Y Y Y N 
2022-04-15 11:55:48.398593: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 31114 MB memory) -> physical GPU (device: 0, name: Vega 20, pci bus id: 0000:3f:00.0)
2022-04-15 11:55:48.739551: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 31114 MB memory) -> physical GPU (device: 1, name: Vega 20, pci bus id: 0000:43:00.0)
2022-04-15 11:55:49.076164: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 31114 MB memory) -> physical GPU (device: 2, name: Vega 20, pci bus id: 0000:46:00.0)
2022-04-15 11:55:49.416177: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 31114 MB memory) -> physical GPU (device: 3, name: Vega 20, pci bus id: 0000:49:00.0)
2022-04-15 11:55:50.358236: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocblas.so
0.5924802541732788 ms on avg
