WARNING:tensorflow:From ./src/matmul.py:9: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From ./src/matmul.py:9: The name tf.logging.ERROR is deprecated. Please use tf.compat.v1.logging.ERROR instead.

M, K, N, repeat_time: 65536 4096 1024 10000
is eager mode:  True
2022-04-15 12:11:13.291229: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libamdhip64.so
2022-04-15 12:11:13.356140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 0 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:3f:00.0
2022-04-15 12:11:13.356185: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 1 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:43:00.0
2022-04-15 12:11:13.356205: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 2 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:46:00.0
2022-04-15 12:11:13.356240: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 3 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:49:00.0
2022-04-15 12:11:13.359944: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocblas.so
2022-04-15 12:11:13.361548: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libMIOpen.so
2022-04-15 12:11:13.377752: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocfft.so
2022-04-15 12:11:13.378039: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocrand.so
2022-04-15 12:11:13.378203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1, 2, 3
2022-04-15 12:11:13.378515: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2022-04-15 12:11:13.388343: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2300000000 Hz
2022-04-15 12:11:13.391857: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5193df0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-04-15 12:11:13.391883: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-04-15 12:11:13.392349: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 0 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:3f:00.0
2022-04-15 12:11:13.392387: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 1 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:43:00.0
2022-04-15 12:11:13.392414: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 2 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:46:00.0
2022-04-15 12:11:13.392439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 3 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:49:00.0
2022-04-15 12:11:13.392459: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocblas.so
2022-04-15 12:11:13.392471: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libMIOpen.so
2022-04-15 12:11:13.392483: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocfft.so
2022-04-15 12:11:13.392495: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocrand.so
2022-04-15 12:11:13.392621: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1, 2, 3
2022-04-15 12:11:13.392651: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-04-15 12:11:13.392660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      0 1 2 3 
2022-04-15 12:11:13.392667: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 0:   N Y Y Y 
2022-04-15 12:11:13.392676: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 1:   Y N Y Y 
2022-04-15 12:11:13.392682: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 2:   Y Y N Y 
2022-04-15 12:11:13.392688: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 3:   Y Y Y N 
2022-04-15 12:11:13.392854: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 31114 MB memory) -> physical GPU (device: 0, name: Vega 20, pci bus id: 0000:3f:00.0)
2022-04-15 12:11:13.740790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 31114 MB memory) -> physical GPU (device: 1, name: Vega 20, pci bus id: 0000:43:00.0)
2022-04-15 12:11:14.053722: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 31114 MB memory) -> physical GPU (device: 2, name: Vega 20, pci bus id: 0000:46:00.0)
2022-04-15 12:11:14.386156: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 31114 MB memory) -> physical GPU (device: 3, name: Vega 20, pci bus id: 0000:49:00.0)
2022-04-15 12:11:15.268080: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocblas.so
58.7909333229065 ms on avg
