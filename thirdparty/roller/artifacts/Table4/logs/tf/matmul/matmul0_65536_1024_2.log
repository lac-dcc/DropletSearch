WARNING:tensorflow:From ./src/matmul.py:9: The name tf.logging.set_verbosity is deprecated. Please use tf.compat.v1.logging.set_verbosity instead.

WARNING:tensorflow:From ./src/matmul.py:9: The name tf.logging.ERROR is deprecated. Please use tf.compat.v1.logging.ERROR instead.

M, K, N, repeat_time: 65536 2 1024 10000
is eager mode:  True
2022-04-15 11:55:24.609972: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libamdhip64.so
2022-04-15 11:55:24.684378: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 0 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:3f:00.0
2022-04-15 11:55:24.684423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 1 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:43:00.0
2022-04-15 11:55:24.684442: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 2 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:46:00.0
2022-04-15 11:55:24.684459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 3 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:49:00.0
2022-04-15 11:55:24.688348: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocblas.so
2022-04-15 11:55:24.689957: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libMIOpen.so
2022-04-15 11:55:24.706376: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocfft.so
2022-04-15 11:55:24.706658: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocrand.so
2022-04-15 11:55:24.706860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1, 2, 3
2022-04-15 11:55:24.707228: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 AVX512F FMA
2022-04-15 11:55:24.723113: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2300000000 Hz
2022-04-15 11:55:24.727574: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x3d60df0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2022-04-15 11:55:24.727619: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2022-04-15 11:55:24.728465: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 0 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:3f:00.0
2022-04-15 11:55:24.728515: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 1 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:43:00.0
2022-04-15 11:55:24.728548: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 2 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:46:00.0
2022-04-15 11:55:24.728579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1650] Found device 3 with properties: 
name: Vega 20
AMDGPU ISA: gfx906
memoryClockRate (GHz) 1.725
pciBusID 0000:49:00.0
2022-04-15 11:55:24.728613: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocblas.so
2022-04-15 11:55:24.728628: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libMIOpen.so
2022-04-15 11:55:24.728643: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocfft.so
2022-04-15 11:55:24.728657: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocrand.so
2022-04-15 11:55:24.728814: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0, 1, 2, 3
2022-04-15 11:55:24.728851: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-04-15 11:55:24.728863: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      0 1 2 3 
2022-04-15 11:55:24.728873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 0:   N Y Y Y 
2022-04-15 11:55:24.728880: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 1:   Y N Y Y 
2022-04-15 11:55:24.728888: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 2:   Y Y N Y 
2022-04-15 11:55:24.728895: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 3:   Y Y Y N 
2022-04-15 11:55:24.729112: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 31114 MB memory) -> physical GPU (device: 0, name: Vega 20, pci bus id: 0000:3f:00.0)
2022-04-15 11:55:25.066537: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:1 with 31114 MB memory) -> physical GPU (device: 1, name: Vega 20, pci bus id: 0000:43:00.0)
2022-04-15 11:55:25.388381: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:2 with 31114 MB memory) -> physical GPU (device: 2, name: Vega 20, pci bus id: 0000:46:00.0)
2022-04-15 11:55:25.717421: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:3 with 31114 MB memory) -> physical GPU (device: 3, name: Vega 20, pci bus id: 0000:49:00.0)
2022-04-15 11:55:26.584118: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library librocblas.so
0.8617163181304932 ms on avg
