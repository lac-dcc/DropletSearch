# kernel generation for nasnet large batch 128

rm -rf nasnet_kernels
mkdir -p nasnet_kernels
mkdir -p nasnet_kernels/src
mkdir -p nasnet_kernels/json
mkdir -p nasnet_kernels/roller_logs

ROLLER_HOME=../../roller
ROLLER_KERNEL_DIR=$PWD
cd $ROLLER_HOME

# AvgPool
LOG_DIR=$ROLLER_KERNEL_DIR/nasnet_kernels/roller_logs
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S1P1 --shape 5376 83 83 3 3 2>&1 |tee $LOG_DIR/pooling2_avg_128_42_83_83_3_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S2P1 --shape 5376 83 83 3 3 2>&1 |tee $LOG_DIR/pooling9_avg_128_42_165_165_3_2_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S2P0 --shape 12288 83 83 1 1 2>&1 |tee $LOG_DIR/pooling7_avg_128_96_165_165_1_2_VALID.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S1P1 --shape 10752 42 42 3 3 2>&1 |tee $LOG_DIR/pooling10_avg_128_84_42_42_3_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S2P1 --shape 10752 42 42 3 3 2>&1 |tee $LOG_DIR/pooling5_avg_128_84_83_83_3_2_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S2P0 --shape 21504 42 42 1 1 2>&1 |tee $LOG_DIR/pooling0_avg_128_168_83_83_1_2_VALID.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S1P1 --shape 21504 42 42 3 3 2>&1 |tee $LOG_DIR/pooling12_avg_128_168_42_42_3_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S1P1 --shape 43008 21 21 3 3 2>&1 |tee $LOG_DIR/pooling11_avg_128_336_21_21_3_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S2P0 --shape 43008 21 21 3 3 2>&1 |tee $LOG_DIR/pooling4_avg_128_336_42_42_3_2_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S2P0 --shape 129024 21 21 1 1 2>&1 |tee $LOG_DIR/pooling3_avg_128_1008_42_42_1_2_VALID.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S1P1 --shape 86016 11 11 3 3 2>&1 |tee $LOG_DIR/pooling6_avg_128_672_11_11_3_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S2P1 --shape 86016 11 11 3 3 2>&1 |tee $LOG_DIR/pooling1_avg_128_672_21_21_3_2_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op avgpool2d_expr_S2P0 --shape 258048 11 11 1 1 2>&1 |tee $LOG_DIR/pooling8_avg_128_2016_21_21_1_2_VALID.log

# Conv
FUSE_PAD=0 CONV_LAYOUT=NCHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_relu_expr_S2D1P0 --shape 128 96 165 165 3 3 3 2>&1 |tee $LOG_DIR/conv0_128_3_331_331_96_3_3_2_1_VALID.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 42 165 165 96 1 1 2>&1 |tee $LOG_DIR/conv1_128_96_165_165_42_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_relu_expr_S1D1P0 --shape 128 42 83 83 96 1 1 2>&1 |tee $LOG_DIR/conv2_128_96_83_83_42_1_1_1_1_VALID.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 42 83 83 42 1 1 2>&1 |tee $LOG_DIR/conv3_128_42_83_83_42_1_1_1_1_VALID.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 84 83 83 168 1 1 2>&1 |tee $LOG_DIR/conv4_128_168_83_83_84_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_expr_S1D1P0 --shape 128 42 83 83 96 1 1 2>&1 |tee $LOG_DIR/conv5_128_96_83_83_42_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_relu_expr_S1D1P0 --shape 128 84 42 42 84 1 1 2>&1 |tee $LOG_DIR/conv6_128_84_42_42_84_1_1_1_1_VALID.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 168 42 42 336 1 1 2>&1 |tee $LOG_DIR/conv7_128_336_42_42_168_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_relu_expr_S1D1P0 --shape 128 168 42 42 168 1 1 2>&1 |tee $LOG_DIR/conv8_128_168_42_42_168_1_1_1_1_VALID.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_expr_S1D1P0 --shape 128 84 42 42 168 1 1 2>&1 |tee $LOG_DIR/conv9_128_168_42_42_84_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 168 42 42 1008 1 1 2>&1 |tee $LOG_DIR/conv10_128_1008_42_42_168_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 336 42 42 1008 1 1 2>&1 |tee $LOG_DIR/conv11_128_1008_42_42_336_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_relu_expr_S1D1P0 --shape 128 336 21 21 336 1 1 2>&1 |tee $LOG_DIR/conv12_128_336_21_21_336_1_1_1_1_VALID.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 336 21 21 1344 1 1 2>&1 |tee $LOG_DIR/conv13_128_1344_21_21_336_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_expr_S1D1P0 --shape 128 168 21 21 1008 1 1 2>&1 |tee $LOG_DIR/conv14_128_1008_21_21_168_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 336 21 21 2016 1 1 2>&1 |tee $LOG_DIR/conv15_128_2016_21_21_336_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 672 21 21 2016 1 1 2>&1 |tee $LOG_DIR/conv16_128_2016_21_21_672_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_relu_expr_S1D1P0 --shape 128 672 11 11 672 1 1 2>&1 |tee $LOG_DIR/conv17_128_672_11_11_672_1_1_1_1_VALID.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 672 11 11 2688 1 1 2>&1 |tee $LOG_DIR/conv18_128_2688_11_11_672_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_expr_S1D1P0 --shape 128 336 11 11 2016 1 1 2>&1 |tee $LOG_DIR/conv19_128_2016_11_11_336_1_1_1_1_SAME.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 672 11 11 4032 1 1 2>&1 |tee $LOG_DIR/conv20_128_4032_11_11_672_1_1_1_1_SAME.log

FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 672 11 11 672 1 1 2>&1 |tee $LOG_DIR/conv17_128_672_11_11_672_1_1_1_1_VALID_bias.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 336 21 21 336 1 1 2>&1 |tee $LOG_DIR/conv12_128_336_21_21_336_1_1_1_1_VALID_bias.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 84 42 42 84 1 1 2>&1 |tee $LOG_DIR/conv6_128_84_42_42_84_1_1_1_1_VALID_bias.log
FUSE_PAD=0 CONV_LAYOUT=CNHW python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op fused_conv_bias_expr_S1D1P0 --shape 128 168 42 42 168 1 1 2>&1 |tee $LOG_DIR/conv8_128_168_42_42_168_1_1_1_1_VALID_bias.log

# DepthwiseConv
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S2D1P3 --shape 128 96 83 83 7 7 2>&1 |tee $LOG_DIR/depthwiseconv20_128_96_165_165_7_2_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P3 --shape 128 42 83 83 7 7 2>&1 |tee $LOG_DIR/depthwiseconv10_128_42_83_83_7_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S2D1P2 --shape 128 42 83 83 5 5 2>&1 |tee $LOG_DIR/depthwiseconv3_128_42_165_165_5_2_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P2 --shape 128 42 83 83 5 5 2>&1 |tee $LOG_DIR/depthwiseconv1_128_42_83_83_5_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P1 --shape 128 42 83 83 3 3 2>&1 |tee $LOG_DIR/depthwiseconv19_128_42_83_83_3_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S2D1P2 --shape 128 96 83 83 5 5 2>&1 |tee $LOG_DIR/depthwiseconv16_128_96_165_165_5_2_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S2D1P3 --shape 128 84 42 42 7 7 2>&1 |tee $LOG_DIR/depthwiseconv4_128_84_83_83_7_2_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P3 --shape 128 84 42 42 7 7 2>&1 |tee $LOG_DIR/depthwiseconv11_128_84_42_42_7_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S2D1P2 --shape 128 84 42 42 5 5 2>&1 |tee $LOG_DIR/depthwiseconv0_128_84_83_83_5_2_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P2 --shape 128 84 42 42 5 5 2>&1 |tee $LOG_DIR/depthwiseconv12_128_84_42_42_5_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P1 --shape 128 84 42 42 3 3 2>&1 |tee $LOG_DIR/depthwiseconv21_128_84_42_42_3_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P1 --shape 128 168 42 42 3 3 2>&1 |tee $LOG_DIR/depthwiseconv13_128_168_42_42_3_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P2 --shape 128 168 42 42 5 5 2>&1 |tee $LOG_DIR/depthwiseconv6_128_168_42_42_5_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P3 --shape 128 336 21 21 7 7 2>&1 |tee $LOG_DIR/depthwiseconv17_128_336_21_21_7_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P2 --shape 128 336 21 21 5 5 2>&1 |tee $LOG_DIR/depthwiseconv2_128_336_21_21_5_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P1 --shape 128 336 21 21 3 3 2>&1 |tee $LOG_DIR/depthwiseconv8_128_336_21_21_3_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S2D1P3 --shape 128 672 11 11 7 7 2>&1 |tee $LOG_DIR/depthwiseconv9_128_672_21_21_7_2_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P3 --shape 128 672 11 11 7 7 2>&1 |tee $LOG_DIR/depthwiseconv14_128_672_11_11_7_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S2D1P2 --shape 128 672 11 11 5 5 2>&1 |tee $LOG_DIR/depthwiseconv7_128_672_21_21_5_2_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P2 --shape 128 672 11 11 5 5 2>&1 |tee $LOG_DIR/depthwiseconv22_128_672_11_11_5_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S1D1P1 --shape 128 672 11 11 3 3 2>&1 |tee $LOG_DIR/depthwiseconv5_128_672_11_11_3_1_1_SAME.log
# TODO fix
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S2D1P0 --shape 128 336 47 47 7 7 2>&1 |tee $LOG_DIR/depthwiseconv17_128_336_21_21_7_1_1_SAME.log
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --schedule_fuse --smem_tiling --reg_tiling --op depthwiseconv_expr_S2D1P0 --shape 128 336 45 45 5 5 2>&1 |tee $LOG_DIR/depthwiseconv2_128_336_21_21_5_1_1_SAME.log
# python3.7 generate_roller_code.py --rs test_depthwiseconv_roller.py --rp 128_336_47_47_7_2_1_VALID --rn roller_DepthwiseConv2dNative_128_336_47_47_7_2_1_VALID --op-type DepthwiseConv2dNative --dst $MODEL_DIR/roller_DepthwiseConv2dNative_[128,336,47,47]_[7,7,336,1]_[128,336,21,21].cu
# python3.7 generate_roller_code.py --rs test_depthwiseconv_roller.py --rp 128_336_45_45_5_2_1_VALID --rn roller_DepthwiseConv2dNative_128_336_45_45_5_2_1_VALID --op-type DepthwiseConv2dNative --dst $MODEL_DIR/roller_DepthwiseConv2dNative_[128,336,45,45]_[5,5,336,1]_[128,336,21,21].cu

# Dot
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op matmul_expr --shape 128 1000 4032 2>&1

# Sum
python test_op_mp.py --code_dir $ROLLER_KERNEL_DIR/nasnet_kernels/src --smem_tiling --reg_tiling --op reduce_expr3 --shape 128 4032 11 11 2>&1

cd $ROLLER_KERNEL_DIR

# kernel code to json
# AvgPool
python parse_code.py --op_type AvgPool --input0_shape 128 42 83 83 --output0_shape 128 42 83 83 --window_shape 3 3 --stride 1 1 --padding 1 1 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S1P1_5376_83_83_3_3.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,42\,83\,83\]_\[128\,42\,83\,83\].json
python parse_code.py --op_type AvgPool --input0_shape 128 42 165 165 --output0_shape 128 42 83 83 --window_shape 3 3 --stride 2 2 --padding 1 1 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S2P1_5376_83_83_3_3.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,42\,165\,165\]_\[128\,42\,83\,83\].json
python parse_code.py --op_type AvgPool --input0_shape 128 96 165 165 --output0_shape 128 96 83 83 --window_shape 1 1 --stride 2 2 --padding 0 0 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S2P0_12288_83_83_1_1.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,96\,165\,165\]_\[128\,96\,83\,83\].json
python parse_code.py --op_type AvgPool --input0_shape 128 84 42 42 --output0_shape 128 84 42 42 --window_shape 3 3 --stride 1 1 --padding 1 1 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S1P1_10752_42_42_3_3.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,84\,42\,42\]_\[128\,84\,42\,42\].json
python parse_code.py --op_type AvgPool --input0_shape 128 84 83 83 --output0_shape 128 84 42 42 --window_shape 3 3 --stride 2 2 --padding 1 1 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S2P1_10752_42_42_3_3.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,84\,83\,83\]_\[128\,84\,42\,42\].json
python parse_code.py --op_type AvgPool --input0_shape 128 168 83 83 --output0_shape 128 168 42 42 --window_shape 1 1 --stride 2 2 --padding 0 0 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S2P0_21504_42_42_1_1.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,168\,83\,83\]_\[128\,168\,42\,42\].json
python parse_code.py --op_type AvgPool --input0_shape 128 168 42 42 --output0_shape 128 168 42 42 --window_shape 3 3 --stride 1 1 --padding 1 1 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S1P1_21504_42_42_3_3.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,168\,42\,42\]_\[128\,168\,42\,42\].json
python parse_code.py --op_type AvgPool --input0_shape 128 336 21 21 --output0_shape 128 336 21 21 --window_shape 3 3 --stride 1 1 --padding 1 1 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S1P1_43008_21_21_3_3.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,336\,21\,21\]_\[128\,336\,21\,21\].json
python parse_code.py --op_type AvgPool --input0_shape 128 336 42 42 --output0_shape 128 336 21 21 --window_shape 3 3 --stride 2 2 --padding 0 0 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S2P0_43008_21_21_3_3.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,336\,42\,42\]_\[128\,336\,21\,21\].json
python parse_code.py --op_type AvgPool --input0_shape 128 1008 42 42 --output0_shape 128 1008 21 21 --window_shape 1 1 --stride 2 2 --padding 0 0 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S2P0_129024_21_21_1_1.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,1008\,42\,42\]_\[128\,1008\,21\,21\].json
python parse_code.py --op_type AvgPool --input0_shape 128 672 11 11 --output0_shape 128 672 11 11 --window_shape 3 3 --stride 1 1 --padding 1 1 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S1P1_86016_11_11_3_3.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,672\,11\,11\]_\[128\,672\,11\,11\].json
python parse_code.py --op_type AvgPool --input0_shape 128 672 21 21 --output0_shape 128 672 11 11 --window_shape 3 3 --stride 2 2 --padding 1 1 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S2P1_86016_11_11_3_3.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,672\,21\,21\]_\[128\,672\,11\,11\].json
python parse_code.py --op_type AvgPool --input0_shape 128 2016 21 21 --output0_shape 128 2016 11 11 --window_shape 1 1 --stride 2 2 --padding 0 0 --source_file ./nasnet_kernels/src/roller_avgpool2d_expr_S2P0_258048_11_11_1_1.cu --json_file ./nasnet_kernels/json/roller_AvgPool_\[128\,2016\,21\,21\]_\[128\,2016\,11\,11\].json

# conv
python parse_code.py --op_type Fused_Convolution_Add_Relu --input0_shape 128 3 331 331 --input1_shape 96 3 3 3 --output0_shape 128 96 165 165 --stride 2 2 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_relu_expr_S2D1P0_128_96_165_165_3_3_3.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,3\,331\,331\]_\[96\,3\,3\,3\]_\[128\,96\,165\,165\]_relu.json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 96 165 165 --input1_shape 42 96 1 1 --output0_shape 128 42 165 165 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_42_165_165_96_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,96\,165\,165\]_\[42\,96\,1\,1\]_\[128\,42\,165\,165\].json
python parse_code.py --op_type Fused_Convolution_Add_Relu --input0_shape 128 96 83 83 --input1_shape 42 96 1 1 --output0_shape 128 42 83 83 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_relu_expr_S1D1P0_128_42_83_83_96_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,96\,83\,83\]_\[42\,96\,1\,1\]_\[128\,42\,83\,83\]_bias_relu.json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 42 83 83 --input1_shape 42 42 1 1 --output0_shape 128 42 83 83 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_42_83_83_42_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,42\,83\,83\]_\[42\,42\,1\,1\]_\[128\,42\,83\,83\].json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 168 83 83 --input1_shape 84 168 1 1 --output0_shape 128 84 83 83 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_84_83_83_168_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,168\,83\,83\]_\[84\,168\,1\,1\]_\[128\,84\,83\,83\].json
python parse_code.py --op_type Convolution --input0_shape 128 96 83 83 --input1_shape 42 96 1 1 --output0_shape 128 42 83 83 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_expr_S1D1P0_128_42_83_83_96_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,96\,83\,83\]_\[42\,96\,1\,1\]_\[128\,42\,83\,83\].json
python parse_code.py --op_type Fused_Convolution_Add_Relu --input0_shape 128 84 42 42 --input1_shape 84 84 1 1 --output0_shape 128 84 42 42 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_relu_expr_S1D1P0_128_84_42_42_84_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,84\,42\,42\]_\[84\,84\,1\,1\]_\[128\,84\,42\,42\]_relu.json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 336 42 42 --input1_shape 168 336 1 1 --output0_shape 128 168 42 42 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_168_42_42_336_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,336\,42\,42\]_\[168\,336\,1\,1\]_\[128\,168\,42\,42\].json
python parse_code.py --op_type Fused_Convolution_Add_Relu --input0_shape 128 168 42 42 --input1_shape 168 168 1 1 --output0_shape 128 168 42 42 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_relu_expr_S1D1P0_128_168_42_42_168_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,168\,42\,42\]_\[168\,168\,1\,1\]_\[128\,168\,42\,42\]_relu.json
python parse_code.py --op_type Convolution --input0_shape 128 168 42 42 --input1_shape 84 168 1 1 --output0_shape 128 84 42 42 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_expr_S1D1P0_128_84_42_42_168_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,168\,42\,42\]_\[84\,168\,1\,1\]_\[128\,84\,42\,42\].json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 1008 42 42 --input1_shape 168 1008 1 1 --output0_shape 128 168 42 42 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_168_42_42_1008_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,1008\,42\,42\]_\[168\,1008\,1\,1\]_\[128\,168\,42\,42\].json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 1008 42 42 --input1_shape 336 1008 1 1 --output0_shape 128 336 42 42 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_336_42_42_1008_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,1008\,42\,42\]_\[336\,1008\,1\,1\]_\[128\,336\,42\,42\].json
python parse_code.py --op_type Fused_Convolution_Add_Relu --input0_shape 128 336 21 21 --input1_shape 336 336 1 1 --output0_shape 128 336 21 21 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_relu_expr_S1D1P0_128_336_21_21_336_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,336\,21\,21\]_\[336\,336\,1\,1\]_\[128\,336\,21\,21\]_relu.json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 1344 21 21 --input1_shape 336 1344 1 1 --output0_shape 128 336 21 21 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_336_21_21_1344_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,1344\,21\,21\]_\[336\,1344\,1\,1\]_\[128\,336\,21\,21\].json
python parse_code.py --op_type Convolution --input0_shape 128 1008 21 21 --input1_shape 168 1008 1 1 --output0_shape 128 168 21 21 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_expr_S1D1P0_128_168_21_21_1008_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,1008\,21\,21\]_\[168\,1008\,1\,1\]_\[128\,168\,21\,21\].json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 2016 21 21 --input1_shape 336 2016 1 1 --output0_shape 128 336 21 21 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_336_21_21_2016_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,2016\,21\,21\]_\[336\,2016\,1\,1\]_\[128\,336\,21\,21\].json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 2016 21 21 --input1_shape 672 2016 1 1 --output0_shape 128 672 21 21 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_672_21_21_2016_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,2016\,21\,21\]_\[672\,2016\,1\,1\]_\[128\,672\,21\,21\].json
python parse_code.py --op_type Fused_Convolution_Add_Relu --input0_shape 128 672 11 11 --input1_shape 672 672 1 1 --output0_shape 128 672 11 11 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_relu_expr_S1D1P0_128_672_11_11_672_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,672\,11\,11\]_\[672\,672\,1\,1\]_\[128\,672\,11\,11\]_relu.json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 2688 11 11 --input1_shape 672 2688 1 1 --output0_shape 128 672 11 11 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_672_11_11_2688_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,2688\,11\,11\]_\[672\,2688\,1\,1\]_\[128\,672\,11\,11\].json
python parse_code.py --op_type Convolution --input0_shape 128 2016 11 11 --input1_shape 336 2016 1 1 --output0_shape 128 336 11 11 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_expr_S1D1P0_128_336_11_11_2016_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,2016\,11\,11\]_\[336\,2016\,1\,1\]_\[128\,336\,11\,11\].json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 4032 11 11 --input1_shape 672 4032 1 1 --output0_shape 128 672 11 11 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_672_11_11_4032_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,4032\,11\,11\]_\[672\,4032\,1\,1\]_\[128\,672\,11\,11\].json

python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 672 11 11 --input1_shape 672 672 1 1 --output0_shape 128 672 11 11 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_672_11_11_672_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,672\,11\,11\]_\[672\,672\,1\,1\]_\[128\,672\,11\,11\]_bias.json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 336 21 21 --input1_shape 336 336 1 1 --output0_shape 128 336 21 21 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_336_21_21_336_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,336\,21\,21\]_\[336\,336\,1\,1\]_\[128\,336\,21\,21\]_bias.json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 84 42 42 --input1_shape 84 84 1 1 --output0_shape 128 84 42 42 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_84_42_42_84_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,84\,42\,42\]_\[84\,84\,1\,1\]_\[128\,84\,42\,42\]_bias.json
python parse_code.py --op_type Fused_Convolution_Add --input0_shape 128 168 42 42 --input1_shape 168 168 1 1 --output0_shape 128 168 42 42 --stride 1 1 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_fused_conv_bias_expr_S1D1P0_128_168_42_42_168_1_1.cu --json_file ./nasnet_kernels/json/roller_Convolution_\[128\,168\,42\,42\]_\[168\,168\,1\,1\]_\[128\,168\,42\,42\]_bias.json

# Depthwise
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 96 165 165 --input1_shape 96 1 7 7 --output0_shape 128 96 83 83 --stride 2 2 --padding 3 3 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S2D1P3_128_96_83_83_7_7.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,96\,165\,165\]_\[7\,7\,96\,1\]_\[128\,96\,83\,83\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 42 83 83 --input1_shape 42 1 7 7 --output0_shape 128 42 83 83 --stride 1 1 --padding 3 3 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P3_128_42_83_83_7_7.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,42\,83\,83\]_\[7\,7\,42\,1\]_\[128\,42\,83\,83\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 42 165 165 --input1_shape 42 1 5 5 --output0_shape 128 42 83 83 --stride 2 2 --padding 2 2 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S2D1P2_128_42_83_83_5_5.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,42\,165\,165\]_\[5\,5\,42\,1\]_\[128\,42\,83\,83\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 42 83 83 --input1_shape 42 1 5 5 --output0_shape 128 42 83 83 --stride 1 1 --padding 2 2 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P2_128_42_83_83_5_5.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,42\,83\,83\]_\[5\,5\,42\,1\]_\[128\,42\,83\,83\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 42 83 83 --input1_shape 42 1 3 3 --output0_shape 128 42 83 83 --stride 1 1 --padding 1 1 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P1_128_42_83_83_3_3.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,42\,83\,83\]_\[3\,3\,42\,1\]_\[128\,42\,83\,83\].json # todo
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 96 165 165 --input1_shape 96 1 5 5 --output0_shape 128 96 83 83 --stride 2 2 --padding 2 2 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S2D1P2_128_96_83_83_5_5.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,96\,165\,165\]_\[5\,5\,96\,1\]_\[128\,96\,83\,83\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 84 83 83 --input1_shape 84 1 7 7 --output0_shape 128 84 42 42 --stride 2 2 --padding 3 3 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S2D1P3_128_84_42_42_7_7.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,84\,83\,83\]_\[7\,7\,84\,1\]_\[128\,84\,42\,42\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 84 42 42 --input1_shape 84 1 7 7 --output0_shape 128 84 42 42 --stride 1 1 --padding 3 3 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P3_128_84_42_42_7_7.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,84\,42\,42\]_\[7\,7\,84\,1\]_\[128\,84\,42\,42\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 84 83 83 --input1_shape 84 1 5 5 --output0_shape 128 84 42 42 --stride 2 2 --padding 2 2 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S2D1P2_128_84_42_42_5_5.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,84\,83\,83\]_\[5\,5\,84\,1\]_\[128\,84\,42\,42\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 84 42 42 --input1_shape 84 1 5 5 --output0_shape 128 84 42 42 --stride 1 1 --padding 2 2 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P2_128_84_42_42_5_5.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,84\,42\,42\]_\[5\,5\,84\,1\]_\[128\,84\,42\,42\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 84 42 42 --input1_shape 84 1 3 3 --output0_shape 128 84 42 42 --stride 1 1 --padding 1 1 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P1_128_84_42_42_3_3.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,84\,42\,42\]_\[3\,3\,84\,1\]_\[128\,84\,42\,42\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 168 42 42 --input1_shape 168 1 3 3 --output0_shape 128 168 42 42 --stride 1 1 --padding 1 1 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P1_128_168_42_42_3_3.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,168\,42\,42\]_\[3\,3\,168\,1\]_\[128\,168\,42\,42\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 168 42 42 --input1_shape 168 1 5 5 --output0_shape 128 168 42 42 --stride 1 1 --padding 2 2 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P2_128_168_42_42_5_5.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,168\,42\,42\]_\[5\,5\,168\,1\]_\[128\,168\,42\,42\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 336 21 21 --input1_shape 336 1 7 7 --output0_shape 128 336 21 21 --stride 1 1 --padding 3 3 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P3_128_336_21_21_7_7.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,336\,21\,21\]_\[7\,7\,336\,1\]_\[128\,336\,21\,21\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 336 21 21 --input1_shape 336 1 5 5 --output0_shape 128 336 21 21 --stride 1 1 --padding 2 2 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P2_128_336_21_21_5_5.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,336\,21\,21\]_\[5\,5\,336\,1\]_\[128\,336\,21\,21\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 336 21 21 --input1_shape 336 1 3 3 --output0_shape 128 336 21 21 --stride 1 1 --padding 1 1 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P1_128_336_21_21_3_3.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,336\,21\,21\]_\[3\,3\,336\,1\]_\[128\,336\,21\,21\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 672 21 21 --input1_shape 672 1 7 7 --output0_shape 128 672 11 11 --stride 2 2 --padding 3 3 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S2D1P3_128_672_11_11_7_7.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,672\,21\,21\]_\[7\,7\,672\,1\]_\[128\,672\,11\,11\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 672 11 11 --input1_shape 672 1 7 7 --output0_shape 128 672 11 11 --stride 1 1 --padding 3 3 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P3_128_672_11_11_7_7.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,672\,11\,11\]_\[7\,7\,672\,1\]_\[128\,672\,11\,11\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 672 21 21 --input1_shape 672 1 5 5 --output0_shape 128 672 11 11 --stride 2 2 --padding 2 2 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S2D1P2_128_672_11_11_5_5.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,672\,21\,21\]_\[5\,5\,672\,1\]_\[128\,672\,11\,11\].json #todo
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 672 11 11 --input1_shape 672 1 5 5 --output0_shape 128 672 11 11 --stride 1 1 --padding 2 2 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P2_128_672_11_11_5_5.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,672\,11\,11\]_\[5\,5\,672\,1\]_\[128\,672\,11\,11\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 672 11 11 --input1_shape 672 1 3 3 --output0_shape 128 672 11 11 --stride 1 1 --padding 1 1 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S1D1P1_128_672_11_11_3_3.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,672\,11\,11\]_\[3\,3\,672\,1\]_\[128\,672\,11\,11\].json
# TODO fix
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 336 47 47 --input1_shape 336 1 7 7 --output0_shape 128 336 21 21 --stride 2 2 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S2D1P0_128_336_47_47_7_7.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,336\,47\,47\]_\[7\,7\,336\,1\]_\[128\,336\,21\,21\].json
python parse_code.py --op_type DepthwiseConv2dNative --input0_shape 128 336 45 45 --input1_shape 336 1 5 5 --output0_shape 128 336 21 21 --stride 2 2 --padding 0 0 --dilation 1 1 --source_file ./nasnet_kernels/src/roller_depthwiseconv_expr_S2D1P0_128_336_45_45_5_5.cu --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_\[128\,336\,45\,45\]_\[5\,5\,336\,1\]_\[128\,336\,21\,21\].json

# Dot
python parse_code.py --op_type Dot --input0_shape 128 4032 --input1_shape 4032 1000 --output0_shape 128 1000 --source_file ./nasnet_kernels/src/roller_matmul_expr_128_1000_4032.cu --json_file ./nasnet_kernels/json/roller_Dot_\[128\,4032\]_\[4032\,1000\]_\[128\,1000\].json

# Sum
python parse_code.py --op_type Sum --input0_shape 128 4032 11 11 --output0_shape 128 4032 --reduction_axis 2 3 --source_file ./nasnet_kernels/src/roller_reduce_expr3_128_4032_11_11.cu --json_file ./nasnet_kernels/json/roller_Sum_\[128\,4032\,11\,11\]_\[128\,4032\].json

# json file to kernel_db
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,1008,42,42]_[128,1008,21,21].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,168,42,42]_[128,168,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,168,83,83]_[128,168,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,2016,21,21]_[128,2016,11,11].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,336,21,21]_[128,336,21,21].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,336,42,42]_[128,336,21,21].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,42,165,165]_[128,42,83,83].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,42,83,83]_[128,42,83,83].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,672,11,11]_[128,672,11,11].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,672,21,21]_[128,672,11,11].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,84,42,42]_[128,84,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,84,83,83]_[128,84,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_AvgPool_[128,96,165,165]_[128,96,83,83].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,1008,21,21]_[168,1008,1,1]_[128,168,21,21].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,1008,42,42]_[168,1008,1,1]_[128,168,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,1008,42,42]_[336,1008,1,1]_[128,336,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,1344,21,21]_[336,1344,1,1]_[128,336,21,21].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,168,42,42]_[168,168,1,1]_[128,168,42,42]_relu.json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,168,42,42]_[84,168,1,1]_[128,84,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,168,83,83]_[84,168,1,1]_[128,84,83,83].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,2016,11,11]_[336,2016,1,1]_[128,336,11,11].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,2016,21,21]_[336,2016,1,1]_[128,336,21,21].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,2016,21,21]_[672,2016,1,1]_[128,672,21,21].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,2688,11,11]_[672,2688,1,1]_[128,672,11,11].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,3,331,331]_[96,3,3,3]_[128,96,165,165]_relu.json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,336,21,21]_[336,336,1,1]_[128,336,21,21]_relu.json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,336,42,42]_[168,336,1,1]_[128,168,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,4032,11,11]_[672,4032,1,1]_[128,672,11,11].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,42,83,83]_[42,42,1,1]_[128,42,83,83].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,672,11,11]_[672,672,1,1]_[128,672,11,11]_relu.json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,84,42,42]_[84,84,1,1]_[128,84,42,42]_relu.json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,96,165,165]_[42,96,1,1]_[128,42,165,165].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,96,83,83]_[42,96,1,1]_[128,42,83,83].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,672,11,11]_[672,672,1,1]_[128,672,11,11]_bias.json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,336,21,21]_[336,336,1,1]_[128,336,21,21]_bias.json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,84,42,42]_[84,84,1,1]_[128,84,42,42]_bias.json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,168,42,42]_[168,168,1,1]_[128,168,42,42]_bias.json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Convolution_[128,96,83,83]_[42,96,1,1]_[128,42,83,83]_bias_relu.json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,168,42,42]_[3,3,168,1]_[128,168,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,168,42,42]_[5,5,168,1]_[128,168,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,336,21,21]_[3,3,336,1]_[128,336,21,21].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,336,21,21]_[5,5,336,1]_[128,336,21,21].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,336,21,21]_[7,7,336,1]_[128,336,21,21].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,42,165,165]_[5,5,42,1]_[128,42,83,83].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,42,83,83]_[3,3,42,1]_[128,42,83,83].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,42,83,83]_[5,5,42,1]_[128,42,83,83].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,42,83,83]_[7,7,42,1]_[128,42,83,83].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,672,11,11]_[3,3,672,1]_[128,672,11,11].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,672,11,11]_[5,5,672,1]_[128,672,11,11].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,672,11,11]_[7,7,672,1]_[128,672,11,11].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,672,21,21]_[5,5,672,1]_[128,672,11,11].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,672,21,21]_[7,7,672,1]_[128,672,11,11].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,84,42,42]_[3,3,84,1]_[128,84,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,84,42,42]_[5,5,84,1]_[128,84,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,84,42,42]_[7,7,84,1]_[128,84,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,84,83,83]_[5,5,84,1]_[128,84,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,84,83,83]_[7,7,84,1]_[128,84,42,42].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,96,165,165]_[5,5,96,1]_[128,96,83,83].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,96,165,165]_[7,7,96,1]_[128,96,83,83].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Dot_[128,4032]_[4032,1000]_[128,1000].json
python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_Sum_[128,4032,11,11]_[128,4032].json

# TODO fix: failure
# python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,336,45,45]_[5,5,336,1]_[128,336,21,21].json
# python convert_external.py --db_path ./nasnet_kernels/ --json_file ./nasnet_kernels/json/roller_DepthwiseConv2dNative_[128,336,47,47]_[7,7,336,1]_[128,336,21,21].json
